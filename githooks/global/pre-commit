#!/bin/bash
# Global pre-commit hook: Enforce git identity
# Deployed via: git config --global core.hooksPath ~/.claude/githooks

EXPECTED_NAME="henrycgbaker"
EXPECTED_EMAIL="henry.c.g.baker@gmail.com"

ACTUAL_NAME=$(git config user.name)
ACTUAL_EMAIL=$(git config user.email)

if [ "$ACTUAL_NAME" != "$EXPECTED_NAME" ]; then
    echo "❌ ERROR: Git user.name is '$ACTUAL_NAME', expected '$EXPECTED_NAME'"
    echo "Fix with: git config user.name '$EXPECTED_NAME'"
    exit 1
fi

if [ "$ACTUAL_EMAIL" != "$EXPECTED_EMAIL" ]; then
    echo "❌ ERROR: Git user.email is '$ACTUAL_EMAIL', expected '$EXPECTED_EMAIL'"
    echo "Fix with: git config user.email '$EXPECTED_EMAIL'"
    exit 1
fi

# Source repo-specific pre-commit if it exists
REPO_HOOK="$(git rev-parse --show-toplevel)/.githooks/pre-commit"
if [ -x "$REPO_HOOK" ]; then
    "$REPO_HOOK"
fi

exit 0
