#!/bin/bash
# ============================================================================
# COMMIT-MSG HOOK
# ============================================================================
# Location: .git/hooks/commit-msg (NOT tracked by git)
# Source:   githooks/commit-msg (tracked template)
#
# Install: cp githooks/commit-msg .git/hooks/commit-msg && chmod +x .git/hooks/commit-msg
# Or run:  ./setup.sh (does this automatically)
# ============================================================================

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# Block AI attribution patterns (but allow product name mentions)
AI_PATTERNS=(
    "Co-Authored-By:.*Claude"
    "Co-Authored-By:.*GPT"
    "Co-Authored-By:.*AI"
    "Generated by Claude"
    "Generated by GPT"
    "Generated with Claude"
    "Generated with GPT"
    "ü§ñ.*Generated"
    "Written by AI"
    "AI-assisted"
)

for pattern in "${AI_PATTERNS[@]}"; do
    if echo "$COMMIT_MSG" | grep -qiE "$pattern"; then
        echo "‚ùå ERROR: Commit message contains AI attribution"
        echo "Pattern matched: $pattern"
        echo "Please remove AI attribution from commit message."
        exit 1
    fi
done

exit 0
