---
phase: 05-claude-plugin-extraction
plan: 05
type: execute
wave: 3
depends_on: ["05-02", "05-03", "05-04"]
files_modified:
  - deploy.sh
  - .env.example
autonomous: true

must_haves:
  truths:
    - "deploy.sh is deleted (clean break, no wrapper)"
    - ".env.example documents CLAUDE_* prefixed keys"
    - "No references to old unprefixed keys in active code"
    - "scripts/lib/ can be removed (all code uses lib/ now)"
  artifacts:
    - path: ".env.example"
      provides: "Documented CLAUDE_* key reference"
      contains: "CLAUDE_DEPLOY_TARGET"
  key_links:
    - from: ".env.example"
      to: "plugins/claude/setup.sh"
      via: "key names match wizard output"
      pattern: "CLAUDE_"
---

<objective>
Delete deploy.sh (clean break per user decision), update .env.example with CLAUDE_* prefixed keys, and clean up legacy scripts/lib/ directory.

Purpose: MIGR-01 (migration complete), roadmap success criterion 8 (deploy.sh deleted). This is the final cleanup that completes the extraction.

Output: deploy.sh removed, .env.example updated, legacy scripts/lib/ cleaned up.
</objective>

<execution_context>
@/Users/henrybaker/.claude/get-shit-done/workflows/execute-plan.md
@/Users/henrybaker/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-claude-plugin-extraction/05-CONTEXT.md
@.planning/phases/05-claude-plugin-extraction/05-02-SUMMARY.md
@.planning/phases/05-claude-plugin-extraction/05-03-SUMMARY.md
@.planning/phases/05-claude-plugin-extraction/05-04-SUMMARY.md
@deploy.sh
@.env.example
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete deploy.sh and legacy scripts/lib/</name>
  <files>deploy.sh, scripts/lib/wizard.sh, scripts/lib/symlinks.sh, scripts/lib/discovery.sh</files>
  <action>
    1. Delete deploy.sh: `git rm deploy.sh`
       Per user decision: clean break, no backwards-compatible wrapper. deploy.sh is kept during extraction for reference and deleted once extraction is complete. Plans 01-04 are the extraction; this plan is the cleanup.

    2. Delete scripts/lib/ directory: `git rm -r scripts/lib/`
       These are the old v1 library files that deploy.sh sourced. The new lib/ directory (created in Phase 4) has replaced them. deploy.sh was the last consumer.

       Check if scripts/ has other contents first. If scripts/ only contains lib/, remove the whole directory. If it has other files (e.g., registry-scan.sh), only remove scripts/lib/.

    3. Verify no remaining references to deploy.sh or scripts/lib/ in active code:
       - `grep -r 'deploy.sh' dotconfigs plugins/ lib/` should return nothing
       - `grep -r 'scripts/lib' dotconfigs plugins/ lib/` should return nothing
       (Planning docs, README, .planning/ may still reference deploy.sh — that's fine, they're docs not code.)
  </action>
  <verify>
    - `ls deploy.sh 2>/dev/null` returns nothing (deleted)
    - `ls scripts/lib/ 2>/dev/null` returns nothing (deleted)
    - `grep -r 'scripts/lib' dotconfigs plugins/ lib/ 2>/dev/null | wc -l` returns 0
  </verify>
  <done>deploy.sh and legacy scripts/lib/ deleted, no dangling references in active code</done>
</task>

<task type="auto">
  <name>Task 2: Update .env.example with CLAUDE_* keys</name>
  <files>.env.example</files>
  <action>
    Rewrite .env.example to document the new CLAUDE_* prefixed keys. This serves as the reference for what `dotconfigs setup claude` generates.

    Content:

    ```
    # dotconfigs configuration
    # Generated by: dotconfigs setup <plugin>
    # Re-run wizard: dotconfigs setup claude

    # ─── Claude Plugin ───────────────────────────────────────────

    # Deploy target directory (where Claude config is deployed)
    CLAUDE_DEPLOY_TARGET=$HOME/.claude

    # Settings.json deployment (true/false)
    CLAUDE_SETTINGS_ENABLED=true

    # CLAUDE.md sections to include (space-separated)
    # Available: communication simplicity documentation git code-style
    CLAUDE_MD_SECTIONS=communication simplicity documentation git code-style

    # Claude Code hooks to enable (space-separated)
    CLAUDE_HOOKS_ENABLED=post-tool-format.py

    # Skills/slash commands to enable (space-separated)
    # Available: commit squash-merge simplicity-check pr-review
    CLAUDE_SKILLS_ENABLED=commit squash-merge simplicity-check

    # GSD framework installation (true/false)
    CLAUDE_GSD_INSTALL=false

    # Git identity for Claude to use
    CLAUDE_GIT_USER_NAME=
    CLAUDE_GIT_USER_EMAIL=

    # ─── Git Plugin (Phase 6) ────────────────────────────────────
    # GIT_* keys will be added by dotconfigs setup git
    ```

    This replaces the current .env.example which uses unprefixed keys.
  </action>
  <verify>
    - `grep 'CLAUDE_DEPLOY_TARGET' .env.example` finds the key
    - `grep 'CLAUDE_MD_SECTIONS' .env.example` finds the key
    - `grep -c 'CLAUDE_' .env.example` shows all claude keys present
    - No unprefixed legacy keys: `grep -E '^(DEPLOY_TARGET|SETTINGS_ENABLED|HOOKS_ENABLED|SKILLS_ENABLED|GSD_INSTALL)=' .env.example` returns nothing
  </verify>
  <done>.env.example documents all CLAUDE_* prefixed keys with descriptions and defaults</done>
</task>

</tasks>

<verification>
- deploy.sh no longer exists
- scripts/lib/ no longer exists (or scripts/ entirely if nothing else in it)
- .env.example uses CLAUDE_* prefixed keys throughout
- No dangling references to old paths in active code
</verification>

<success_criteria>
- deploy.sh deleted from git
- .env.example contains only CLAUDE_* prefixed keys (for claude section)
- No broken imports or references in dotconfigs, plugins/, or lib/
</success_criteria>

<output>
After completion, create `.planning/phases/05-claude-plugin-extraction/05-05-SUMMARY.md`
</output>
