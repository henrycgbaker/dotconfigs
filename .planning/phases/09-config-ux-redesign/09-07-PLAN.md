---
phase: 09-config-ux-redesign
plan: 07
type: execute
wave: 1
depends_on: []
files_modified:
  - githooks/commit-msg
  - githooks/pre-commit
  - lib/discovery.sh
  - .planning/ROADMAP.md
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Legacy githooks/ directory is removed — all hooks live in plugins/git/hooks/"
    - "Orphaned discover_githooks function is removed from lib/discovery.sh"
    - ".env→JSON migration deferral is recorded in ROADMAP accumulated context"
  artifacts:
    - path: "lib/discovery.sh"
      provides: "Clean discovery functions with no orphaned code"
    - path: ".planning/ROADMAP.md"
      provides: "Recorded .env→JSON deferral decision"
  key_links:
    - from: "plugins/git/hooks/"
      to: "plugins/git/deploy.sh"
      via: "hook deployment"
      pattern: "PLUGIN_DIR.*hooks"
---

<objective>
Remove the legacy `githooks/` directory (2 outdated hooks replaced by `plugins/git/hooks/` with 7 hooks), clean up orphaned discovery functions, and record the .env→JSON migration deferral in ROADMAP.

Purpose: Eliminate dead code and stale artefacts that could confuse future maintenance. Document the .env→JSON discussion outcome for v3 reference.
Output: Removed `githooks/` directory, cleaned `lib/discovery.sh`, updated ROADMAP accumulated context.
</objective>

<execution_context>
@/Users/henrybaker/.claude/get-shit-done/workflows/execute-plan.md
@/Users/henrybaker/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/v2.0-MILESTONE-AUDIT.md
@lib/discovery.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove legacy githooks/ directory and orphaned discovery functions</name>
  <files>githooks/commit-msg, githooks/pre-commit, lib/discovery.sh</files>
  <action>
    **Step 1: Delete the `githooks/` directory.**
    Remove both files (`githooks/commit-msg` and `githooks/pre-commit`) and the directory itself. These hooks are outdated — the current source of truth is `plugins/git/hooks/` which has 7 hooks.

    ```bash
    rm -rf githooks/
    ```

    **Step 2: Remove orphaned discovery functions from `lib/discovery.sh`.**
    Remove these three functions that are defined but never called (identified in v2.0-MILESTONE-AUDIT.md tech debt):
    - `discover_githooks()` — references the now-deleted `githooks/` directory
    - `discover_settings_templates()` — orphaned, unused
    - `discover_hooks_conf_profiles()` — orphaned, unused (deprecated in 08-01)

    Read `lib/discovery.sh` first to find exact function boundaries, then remove each complete function definition (from the comment above the function to the closing `}`).

    **Step 3: Verify no remaining references to `githooks/` directory.**
    Search the codebase (excluding .planning/ and docs/) for any remaining references to the `githooks/` path. The README and ROSTER references will be handled in plan 09-08. Config discovery paths (`.githooks/config`) are a DIFFERENT thing — that's a per-project config discovery path, not a reference to the root-level `githooks/` directory. Leave those alone.
  </action>
  <verify>
    Run: `ls githooks/ 2>&1` — should show "No such file or directory".
    Run: `grep -n 'discover_githooks\|discover_settings_templates\|discover_hooks_conf_profiles' lib/discovery.sh` — should return 0 matches.
    Run: `grep -rn 'githooks/' --include='*.sh' . | grep -v '.planning/' | grep -v '.githooks/'` — should return 0 matches (`.githooks/config` is a different path and won't match `githooks/`).
  </verify>
  <done>Legacy `githooks/` directory deleted. Three orphaned discovery functions removed from `lib/discovery.sh`. No remaining shell references to the deleted directory.</done>
</task>

<task type="auto">
  <name>Task 2: Record .env→JSON migration deferral in ROADMAP</name>
  <files>.planning/ROADMAP.md</files>
  <action>
    Add a new entry to the "Accumulated Context" section of `.planning/ROADMAP.md` (after the existing "From v1.0" subsection). Add a new subsection:

    ```markdown
    ### Deferred to v3

    - **.env → JSON migration:** Discussed during Phase 9 planning. Current .env format works well — quoting bug was fixed in quick-002 and is not symptomatic of deeper format issues. JSON would require jq dependency (problematic for bash 3.2 portability) and a migration path for existing users. Deferred to v3 if the need arises.
    ```

    Place this after the "From v1.0" subsection and before "### Target Directory Structure".
  </action>
  <verify>
    Run: `grep -A3 'Deferred to v3' .planning/ROADMAP.md` — should show the .env → JSON entry.
  </verify>
  <done>.env→JSON deferral recorded in ROADMAP accumulated context with rationale.</done>
</task>

</tasks>

<verification>
1. `githooks/` directory does not exist
2. `lib/discovery.sh` has no `discover_githooks`, `discover_settings_templates`, or `discover_hooks_conf_profiles` functions
3. ROADMAP.md contains "Deferred to v3" section with .env → JSON entry
4. No shell scripts (outside .planning/) reference the deleted `githooks/` directory
</verification>

<success_criteria>
- Legacy `githooks/` directory fully removed (was 2 hooks, replaced by 7 in `plugins/git/hooks/`)
- Three orphaned discovery functions removed (tech debt from v2.0 audit)
- .env→JSON migration discussion outcome documented for v3 reference
</success_criteria>

<output>
After completion, create `.planning/phases/09-config-ux-redesign/09-07-SUMMARY.md`
</output>
