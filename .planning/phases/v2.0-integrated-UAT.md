---
status: testing
phase: v2.0-integrated
source: All SUMMARY.md files from phases 04-09
started: 2026-02-09T17:15:00Z
updated: 2026-02-09T19:30:00Z
---

## Current Test
<!-- All tests complete -->

number: complete
name: All tests passed
awaiting: none

## Tests

### 1. CLI Help and Usage
expected: Run `./dotconfigs` with no arguments. Shows usage with commands (global-configs, deploy, project-configs, status, list, help) and lists available plugins (claude, git).
result: pass

### 2. Contextual Help
expected: Run `./dotconfigs help deploy`. Shows deploy-specific help with --dry-run, --force, --interactive flags documented.
result: pass

### 3. Plugin Listing
expected: Run `./dotconfigs list`. Shows both "claude" and "git" plugins with "deployed" / "not deployed" status (not "installed").
result: pass

### 4. Invalid Plugin Error
expected: Run `./dotconfigs global-configs nonexistent`. Shows error message with list of available plugins (claude, git). Exits non-zero.
result: pass

### 5. Claude Global-Configs Wizard (First Run)
expected: Run `./dotconfigs global-configs claude` (with no existing .env). Shows category-based opt-in menu with 3 categories (Deploy targets, Content, Behaviour). User selects which categories to configure. Unselected items remain unset. Summary shown before saving with "[not managed]" for unselected configs.
result: pass (retest — GSD removed, previews added, settings.json simplified, exclusion defaults fixed, destination choice added)

### 6. Git Global-Configs Wizard (First Run)
expected: Run `./dotconfigs global-configs git` (with no existing .env). Shows 4 categories (Identity, Workflow, Aliases, Hooks). Uses read-based numbered prompts (no `select` dropdown menus). Identity pre-fills from `git config --global`. Summary shown before saving.
result: pass (retest — config path default changed to 4, save message fixed, set -e crash fixed, per-hook scope deferred to Phase 10)

### 7. Wizard Edit Mode (Re-run)
expected: Run `./dotconfigs global-configs claude` again after saving config. Enters edit mode showing numbered list of current config values. User can pick a number to edit specific items. "[not managed]" shown for unset configs.
result: pass (retest — edit mode fixed in 003-03, labels descriptive, rerun option added)

### 8. Deploy Dry Run
expected: Run `./dotconfigs deploy --dry-run` (after global-configs). Shows what would be deployed without making changes. Prints "Would create/Would link" messages. No filesystem changes made.
result: pass

### 9. Claude Deploy
expected: Run `./dotconfigs deploy claude` (after global-configs). Deploys settings.json (assembled from templates), CLAUDE.md, hooks, and skills to target directory. Applies CLAUDE.md exclusion to .git/info/exclude if enabled. Shows deploy summary with created/unchanged counts.
result: issue
reported: "Deploy crashes at CLAUDE.md build. Line 203 of deploy.sh does '> output_file' which fails when target is a broken symlink (user had CLAUDE.md -> old dotclaude repo). Deploy should detect and handle broken symlinks — remove and recreate, or warn."
severity: blocker

### 10. Git Deploy
expected: Run `./dotconfigs deploy git` (after global-configs). Applies git config --global settings (identity, workflow, aliases). Shows drift warnings if config differs from .env. Prints deploy summary.
result: pass

### 11. Status Command + Setup
expected: Run `./dotconfigs setup` then `dotconfigs`/`dots` from PATH. Setup creates PATH symlinks, shows next-steps. No deploy target question.
result: pass (retest — setup simplified, symlink resolution fixed)

### 12. Deploy Idempotency
expected: Run `./dotconfigs deploy` twice. Second run shows "Unchanged" counts — no errors, no re-creation of existing files. Safe to run repeatedly.
result: pass (all symlinked — settings.json, CLAUDE.md, hooks, skills. Content-change detection for generated files. --force resolves foreign conflicts, second run shows all Unchanged)

### 13. Project-Configs with G/L Badges
expected: From a git repo (not dotconfigs), run `dotconfigs project-configs .`. Shows globally-set values with cyan [G] badge. Local overrides shown with green [L] badge. Interactive wizard for project-level configuration.
result: pass (verified wizard starts correctly with [G] badge, detects brownfield project)

### 14. Git Hooks Exist
expected: Run `ls plugins/git/hooks/`. Should contain 7 hooks: commit-msg, pre-commit, pre-push, prepare-commit-msg, post-merge, post-checkout, post-rewrite. All executable.
result: pass (7 hooks present, permissions fixed to 755)

### 15. dots Symlink
expected: `dots` exists as a symlink pointing to `dotconfigs`. Running `./dots list` produces identical output to `./dotconfigs list`. Also: `dots` should get a PATH symlink too, not just `dotconfigs`.
result: pass (dots → dotconfigs in repo, PATH symlinks at ~/.local/bin/dotconfigs and ~/.local/bin/dots, identical output)

### 16. PATH Symlink
expected: After running `./dotconfigs deploy`, check if `~/.local/bin/dotconfigs` symlink exists. Verify `dotconfigs` is callable from another directory.
result: pass

### 17. Roster Generation
expected: Run `bash scripts/generate-roster.sh`. Generates docs/ROSTER.md with tables for 7 git hooks, 2 claude hooks, 4 commands. No errors.
result: pass (7 git hooks, 2 claude hooks, 4 commands)

## Summary

total: 17
passed: 16
issues: 5 (3 major fixed via quick-003, 2 blockers fixed inline, all resolved)
pending: 0
skipped: 0

## Gaps

- truth: "Claude wizard offers appropriate opt-in categories without GSD install, with content previews, simple settings template, and both CLAUDE.md exclusion options"
  status: failed
  reason: "User reported: GSD install doesn't belong (npm), no content preview, settings assembly overengineered, CLAUDE.md exclusion missing 'both' option"
  severity: major
  test: 5
  root_cause: ""
  artifacts: []
  missing: []
  debug_session: ""

- truth: "Git wizard shows clear prompts, correct wording, granular hook scope control, and config path transparency"
  status: failed
  reason: "User reported: confusing default/question mixing, 'manage' should be 'add', all-or-nothing hook scope, no tracked/untracked indicators, no save path shown, missing .claude/hooks.conf option"
  severity: major
  test: 6
  root_cause: ""
  artifacts:
    - path: "plugins/git/setup.sh"
      issue: "Hook section needs per-hook scope/location granularity"
  missing: []
  debug_session: ""

- truth: "Edit mode shows clear labeled config values with working number selection"
  status: failed
  reason: "User reported: edit mode completely broken — garbled labels, non-functional selection, missing hook/skill config in first run, no 'rerun as new' option"
  severity: major
  test: 7
  root_cause: ""
  artifacts:
    - path: "plugins/claude/setup.sh"
      issue: "Edit mode display parsing broken from item 7 onwards"
  missing: []
  debug_session: ""

- truth: "Claude deploy handles broken symlinks and creates CLAUDE.md successfully"
  status: fixed
  reason: "User reported: deploy crashes at line 203 when CLAUDE.md is a broken symlink to old dotclaude repo"
  severity: blocker
  test: 9
  root_cause: "Line 203 does '> output_file' which fails on broken symlink — no detection/cleanup of stale symlinks before writing"
  fix: "Added broken symlink detection (-L && ! -e) and rm -f before writing, plus mkdir -p safety net in _claude_build_md"
  artifacts:
    - path: "plugins/claude/deploy.sh"
      issue: "FIXED: broken symlink check added before truncate"

- truth: "Status command shows deployment state visibly"
  status: fixed
  reason: "User reported: crashes silently even with valid .env + deploy done. bash -x trace shows crash at ((count_drift++)) when count_drift=0."
  severity: blocker
  test: 11
  root_cause: "Three issues: (1) ((var++)) when var=0 returns exit code 1 under set -e. (2) check_file_state() returned non-zero exit codes (1, 2) which also killed script under set -e. (3) stale 'dots setup' references."
  fix: "Replaced all ((var++)) with var=$((var + 1)) in claude/deploy.sh, git/deploy.sh. Changed check_file_state() to always return 0 (state communicated via stdout). Updated all 'dots' references to 'dotconfigs' across CLI and plugins."
  artifacts:
    - path: "plugins/claude/deploy.sh"
      issue: "FIXED: all ((var++)) replaced"
    - path: "plugins/git/deploy.sh"
      issue: "FIXED: all ((var++)) replaced"
    - path: "lib/symlinks.sh"
      issue: "FIXED: check_file_state always returns 0"
    - path: "dotconfigs"
      issue: "FIXED: all 'dots' references updated to 'dotconfigs'"

- truth: "Setup command performs one-time tool initialisation (deploy target, PATH, next-steps)"
  status: failed
  reason: "User reported: ./dotconfigs setup only asks deploy target — missing PATH setup, doesn't use 'dotconfigs' naming in output. Per 09-CONTEXT.md line 12 and 002-03-PLAN.md, setup should be its own command (not redirect to global-configs) that does one-time tool init."
  severity: major
  test: 11
  root_cause: "cmd_setup() was implemented as minimal deploy-target-only wizard. Missing PATH symlink creation and proper next-steps messaging with 'dotconfigs' naming."
  artifacts:
    - path: "dotconfigs"
      issue: "cmd_setup() lines 230-250: only asks deploy target, no PATH setup, uses 'dots' naming"
  missing:
    - "Add PATH symlink creation to setup (call _create_path_symlink)"
    - "Update next-steps message to use 'dotconfigs' naming"
    - "Add dots PATH symlink alongside dotconfigs"
  debug_session: ""
  requirements_source: "09-CONTEXT.md line 12: 'dots setup — one-time tool initialisation'; 002-03-PLAN.md lines 69-92"
