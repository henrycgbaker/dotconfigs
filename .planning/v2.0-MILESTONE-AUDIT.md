---
milestone: v2.0
audited: 2026-02-09T17:00:00Z
status: tech_debt
scores:
  requirements: 32/32
  phases: 6/6
  integration: 41/41
  flows: 7/7
tech_debt:
  - phase: 04-core-infrastructure-cli-entry-point
    items:
      - "3 orphaned discovery functions: discover_githooks, discover_settings_templates, discover_hooks_conf_profiles (defined but unused)"
  - phase: 08-hooks-workflows-review
    items:
      - "lib/config.sh load_git_hook_config helper defined but hooks use inline config loading instead (DRY opportunity)"
---

# v2.0 Milestone Audit Report

**Milestone:** v2.0 — Plugin Architecture
**Audited:** 2026-02-09 (final audit after Phase 9 completion)
**Previous Audits:** 2026-02-08 (tech_debt), 2026-02-07 (gaps_found — 2 bugs fixed)
**Status:** PASSED (minor tech debt)

## Executive Summary

All 32 v2.0 requirements satisfied. All 6 phases verified independently (55/55 success criteria). Cross-phase integration solid with 41 connections verified and 7 end-to-end user flows complete. No blocking issues. Minor tech debt (3 orphaned functions, 1 DRY opportunity) — both carried forward from previous audit, unchanged.

Phase 9 (Config UX Redesign) completed the milestone with opt-in config selection, G/L colour badges, CLAUDE.md exclusion, settings.json assembly, CLI naming reversal, and bug fixes. Initial Phase 9 verification found 5 gaps — all closed via plans 09-06 through 09-09 and re-verified.

## Phase Verification Summary

| Phase | Goal | Score | Status | Verified |
|-------|------|-------|--------|----------|
| 4. Core Infrastructure & CLI Entry Point | CLI skeleton, plugin discovery, shared libs | 6/6 | PASSED | 2026-02-07 |
| 5. Claude Plugin Extraction | Migrate deploy.sh → plugins/claude/ | 8/8 | PASSED | 2026-02-07 |
| 6. Git Plugin | Hooks, identity, workflow, aliases | 8/8 | PASSED | 2026-02-07 |
| 7. Integration & Polish | Status, help, deploy flags, README | 10/10 | PASSED | 2026-02-07 |
| 8. Hooks & Workflows Review | Audit + rationalise all hooks | 10/10 | PASSED | 2026-02-08 |
| 9. Config UX Redesign | Opt-in config, G/L badges, naming, bugs | 13/13 | PASSED | 2026-02-09 |

**All phases: 55/55 success criteria verified (100%)**

## Requirements Coverage

### Plugin Infrastructure (5/5)

| Requirement | Description | Phase | Status |
|-------------|-------------|-------|--------|
| PLUG-01 | Plugin discovery via filesystem scan | 4 | ✓ |
| PLUG-02 | Plugin interface contract (setup.sh + deploy.sh) | 4 | ✓ |
| PLUG-03 | Lazy plugin loading | 4 | ✓ |
| PLUG-04 | Shared library layer (lib/*.sh) | 4 | ✓ |
| PLUG-05 | Plugin isolation (no cross-plugin imports) | 4 | ✓ |

### CLI Restructure (7/7)

| Requirement | Description | Phase | Status |
|-------------|-------------|-------|--------|
| CLI-01 | Single `dotconfigs` entry point | 4 | ✓ |
| CLI-02 | `dotconfigs setup [plugin]` | 5 | ✓ |
| CLI-03 | `dotconfigs deploy [plugin]` | 5 | ✓ |
| CLI-04 | `dotconfigs status [plugin]` | 7 | ✓ |
| CLI-05 | `dotconfigs list` | 7 | ✓ |
| CLI-06 | `dotconfigs help [command]` | 7 | ✓ |
| CLI-07 | `dotconfigs` on PATH | 7 | ✓ |

### Claude Plugin (4/4)

| Requirement | Description | Phase | Status |
|-------------|-------------|-------|--------|
| CLPL-01 | Wizard in plugins/claude/setup.sh | 5 | ✓ |
| CLPL-02 | Deploy in plugins/claude/deploy.sh | 5 | ✓ |
| CLPL-03 | Assets under plugins/claude/ | 5 | ✓ |
| CLPL-04 | Project scaffolding preserved | 5 | ✓ |

### Git Plugin (5/5)

| Requirement | Description | Phase | Status |
|-------------|-------------|-------|--------|
| GITP-01 | Git hooks deployment | 6 | ✓ |
| GITP-02 | Git identity wizard | 6 | ✓ |
| GITP-03 | Git workflow settings | 6 | ✓ |
| GITP-04 | Git aliases | 6 | ✓ |
| GITP-05 | Hook scope (per-project default, global opt-in) | 6 | ✓ |

### Configuration (4/4)

| Requirement | Description | Phase | Status |
|-------------|-------------|-------|--------|
| CONF-01 | .env namespacing (CLAUDE_*, GIT_*) | 5 | ✓ |
| CONF-02 | Unified .env file | 5 | ✓ |
| CONF-03 | Pre-filled wizard defaults on re-run | 5 | ✓ |
| CONF-04 | .env versioning (DOTCONFIGS_VERSION=2.0) | 5 | ✓ |

### Migration & Compatibility (5/5)

| Requirement | Description | Phase | Status |
|-------------|-------------|-------|--------|
| MIGR-01 | Strangler fig migration | 5 | ✓ |
| MIGR-02 | deploy.sh removed (clean break) | 7 | ✓ |
| COMP-01 | Bash 3.2 compatible | 4 | ✓ |
| COMP-02 | macOS and Linux portable | 7 | ✓ |
| COMP-03 | GSD framework coexistence | 5 | ✓ |

### Quality (2/2)

| Requirement | Description | Phase | Status |
|-------------|-------------|-------|--------|
| QUAL-03 | Idempotent deploy | 7 | ✓ |
| QUAL-04 | Conflict detection | 7 | ✓ |

**Total: 32/32 requirements satisfied (100%)**

## Cross-Phase Integration

### Wiring Verified (41/41)

| Connection | From | To | Status |
|------------|------|----|--------|
| CLI → plugin routing | Phase 4 | Phases 5, 6, 8 | ✓ |
| lib/wizard.sh consumers | Phase 4 | Phases 5, 6, 9 | ✓ |
| lib/symlinks.sh consumers | Phase 4 | Phases 5, 6 | ✓ |
| lib/discovery.sh consumers | Phase 4 | Phases 5, 7 | ✓ |
| lib/validation.sh consumers | Phase 4 | Phases 6, 7 | ✓ |
| lib/colours.sh consumers | Phase 7 | Phases 5, 6, 9, CLI | ✓ |
| lib/colours.sh G/L badges | Phase 9 | Phases 5, 6 (project.sh) | ✓ |
| lib/config.sh sourcing | Phase 8 | Phase 4 (eager load) | ✓ |
| CLAUDE_* .env keys | Phase 5 (write) | Phase 7 (read) | ✓ |
| GIT_* .env keys | Phase 6 (write) | Phase 7 (read) | ✓ |
| Deploy flag passthrough | Phase 7 (parse) | Phases 5, 6 (honour) | ✓ |
| New hooks deployment | Phase 8 (create) | Phase 6 (deploy) | ✓ |
| Config templates | Phase 8 (create) | Phases 5, 6 (deploy) | ✓ |
| Opt-in model (unset pattern) | Phase 9 | Phases 5, 6 (setup.sh) | ✓ |
| Edit mode on re-run | Phase 9 | Phase 5 (setup.sh) | ✓ |
| CLAUDE.md exclusion | Phase 9 | Phase 5 (deploy.sh) | ✓ |
| Settings.json assembly | Phase 9 | Phase 5 (deploy.sh) | ✓ |
| CLI naming (dots → dotconfigs) | Phase 9 | All phases (docs, CLI) | ✓ |
| List terminology (deployed) | Phase 9 | Phase 7 (CLI) | ✓ |

### E2E User Flows (7/7)

| Flow | Status |
|------|--------|
| Fresh install (clone → global-configs → deploy → verify) | ✓ Complete |
| Re-run setup with edit mode (pre-fills → edit → save → deploy) | ✓ Complete |
| Project scaffold (`dotconfigs project-configs .` → all files created) | ✓ Complete |
| Status check (`dotconfigs status` → per-plugin drift detection) | ✓ Complete |
| New plugin (create dir → appears in list → routes work) | ✓ Complete |
| PATH availability (after deploy → callable from any directory) | ✓ Complete |
| Hook configuration override (global → project config → hook runtime) | ✓ Complete |

### Previous Bugs (All Fixed)

| Bug | Found | Fixed | Verification |
|-----|-------|-------|--------------|
| Missing `colour_cyan()` in lib/colours.sh | 2026-02-07 | ✓ | Function exists |
| Uninitialised `PLUGIN_DIR` in claude/project.sh | 2026-02-07 | ✓ | Set via BASH_SOURCE |
| Boolean opt-out wrote "false" instead of unset | 2026-02-09 | ✓ | Uses `unset` pattern |
| Collections defaulted to ALL selected on first run | 2026-02-09 | ✓ | Starts with empty arrays |
| Legacy githooks/ directory still existed | 2026-02-09 | ✓ | Removed from codebase |
| README used stale "dots" naming | 2026-02-09 | ✓ | All docs use "dotconfigs" |
| Usage guide had TODO markers and dotclaude references | 2026-02-09 | ✓ | Cleaned |

## Bash 3.2 Compliance

**Status:** PASS

No bash 4+ features found across all phases:
- `local -n` / `declare -n` (namerefs): 0 matches
- `declare -A` (associative arrays): 0 matches
- `${var,,}` / `${var^^}` (case conversion): 0 matches

## Tech Debt

4 items across 2 phases. None are blockers.

### Phase 4: Orphaned Discovery Functions

3 functions in `lib/discovery.sh` defined but never called:
- `discover_githooks` — obsolete (architecture changed to plugins/git/hooks/)
- `discover_settings_templates` — unused (settings templates hardcoded in claude/project.sh)
- `discover_hooks_conf_profiles` — planned but not consumed

**Impact:** Low. No broken dependencies. Dead code cleanup opportunity.

### Phase 8: Inline Config Loading in Hooks

`lib/config.sh` defines `load_git_hook_config` helper, but git hooks implement inline config loading instead of calling this shared helper. DRY opportunity, not a bug.

**Impact:** Low. Hooks work correctly. Could reduce duplication if hooks are modified later.

## Deferred Decisions

| Decision | Phase | Rationale | Target |
|----------|-------|-----------|--------|
| .env → JSON migration | 9 | Current .env works well; JSON would require jq dependency | v3 |
| Explore agent hook | 8 | Claude Code API doesn't expose model control for explore agents | External GSD PR |
| Shell plugin | PROJECT.md | Focus v2 on restructure + 2 plugins | v3 |

## Deliverable Summary

| Category | Count |
|----------|-------|
| CLI entry point | 1 (660 lines) |
| CLI alias | 1 (dots symlink) |
| Shared libraries | 6 (wizard, symlinks, discovery, validation, colours, config) |
| Plugin scripts | 8 (claude: setup, deploy, project; git: setup, deploy, project; + 2 DESCRIPTION) |
| Git hooks | 7 (commit-msg, pre-push, pre-commit, prepare-commit-msg, post-merge, post-checkout, post-rewrite) |
| Claude hooks | 2 (block-destructive.sh, post-tool-format.py) |
| Commands/skills | 4 (commit, squash-merge, simplicity-check, pr-review) |
| Templates | 16+ (claude-md sections, settings, hooks-conf, git-hooks.conf, claude-hooks.conf) |
| Documentation | 4 (README.md, .env.example, docs/ROSTER.md, docs/usage-guide.md) |
| Scripts | 1 (generate-roster.sh) |

---

*Audited: 2026-02-09*
*Method: Phase verification aggregation + gsd-integration-checker cross-phase analysis*
*Previous audits: 2026-02-08 (tech_debt), 2026-02-07 (gaps_found → resolved)*
