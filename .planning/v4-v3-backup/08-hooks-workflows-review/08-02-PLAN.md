---
phase: 08-hooks-workflows-review
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - plugins/claude/commands/squash-merge.md
autonomous: true

must_haves:
  truths:
    - "/squash-merge command follows industry best practice for solo dev + feature branch workflow"
    - "Tradeoff documentation explains git tracking limitation and why branch deletion handles it"
    - "Decision documented on whether explore agent model selection hooks are feasible (defer or not-feasible — zero implementation in Phase 08)"
  artifacts:
    - path: "plugins/claude/commands/squash-merge.md"
      provides: "Audited squash-merge command with tradeoff docs"
      contains: "Tradeoffs"
  key_links: []
---

<objective>
Audit the /squash-merge command against industry best practice and research explore agent model selection hooks.

Purpose: These are independent audit/research tasks that don't depend on the config architecture work. The squash-merge command needs validation and tradeoff documentation. The explore agent hook needs research before a build/no-build decision can be made.

Output: Updated squash-merge.md with best-practice alignment and tradeoffs. Explore agent findings documented in the summary.
</objective>

<execution_context>
@/Users/henrybaker/.claude/get-shit-done/workflows/execute-plan.md
@/Users/henrybaker/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-hooks-workflows-review/08-RESEARCH.md
@plugins/claude/commands/squash-merge.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Audit and update /squash-merge command</name>
  <files>plugins/claude/commands/squash-merge.md</files>
  <action>
Audit the existing /squash-merge command against industry best practice for squash merge workflows. Per user decision: keep as the ONLY merge command (no /merge-branch alternative).

**Audit checklist (from research — Graphite squash merge best practices):**
1. Pre-flight checks: verify not on main, check uncommitted changes, show commits — ALREADY DONE ✓
2. Show diff stat before merge — ALREADY DONE ✓
3. Switch to main and pull latest — ALREADY DONE ✓
4. Squash merge — ALREADY DONE ✓
5. Clean conventional commit message — ALREADY DONE ✓
6. Delete branch + push — ALREADY DONE ✓

**Missing from current implementation (add these):**
1. **Pre-flight: check if branch is up-to-date with main** — Add `git fetch origin main` and `git log HEAD..origin/main --oneline` before merge to warn if main has diverged. If main has new commits, suggest rebasing first.
2. **Remote branch cleanup** — After deleting local branch, also delete remote tracking branch: `git push origin --delete <branch-name>` (with error handling if remote branch doesn't exist)
3. **Tradeoffs section** — Add a `## Tradeoffs` section explaining:
   - Squash merge creates a single commit on main → clean linear history
   - Individual branch commits are lost in git log (but visible in PR history if using GitHub)
   - Branch deletion is important: branch refs are the only way to find individual commits after squash
   - Why this is the right choice for solo dev: clean main history matters more than preserving every WIP commit
   - `git reflog` can still recover branch commits for ~90 days after deletion

**Update the process to include these steps.** Keep the command concise — it's a skill file, not documentation. Add the tradeoffs as a brief section at the end.
  </action>
  <verify>
- `grep -c 'Tradeoff' plugins/claude/commands/squash-merge.md` returns 1+ (tradeoffs section exists)
- `grep 'origin.*delete' plugins/claude/commands/squash-merge.md` finds remote cleanup step
- `grep 'fetch.*main\|rebase' plugins/claude/commands/squash-merge.md` finds divergence check
- File is valid markdown
  </verify>
  <done>/squash-merge includes divergence check, remote branch cleanup, and tradeoff documentation. Follows industry best practice for solo dev squash merge workflow.</done>
</task>

<task type="auto">
  <name>Task 2: Research explore agent model selection</name>
  <files></files>
  <action>
Research how Claude Code's explore agent model selection actually works, to determine whether a hook can influence which model the explore agent uses.

**Research steps:**
1. Check Claude Code documentation for SubagentStart hook event — does it fire? What JSON does it receive?
2. Check if PreToolUse for the Task tool (which spawns explore agents) includes a `model` field in tool_input
3. Check `~/.claude/settings.json` for any `subagentModel` or `exploreModel` configuration
4. Check if the `--model` flag or `model` setting in settings.json affects explore agents
5. Look at Claude Code hooks documentation for any mention of SubagentStart, SubagentEnd, or agent model configuration

**Decision criteria — research outcome is a documented decision ONLY:**
- If hooks CAN influence model selection → document the mechanism and **defer implementation to a future phase** (not Phase 08)
- If hooks CANNOT influence model selection → document the finding and **defer to GSD framework** (external PR, already in deferred ideas)
- If unclear → document what's known and **defer** pending more information

**IMPORTANT: Zero implementation in Phase 08 regardless of findings.** This task produces documentation only. Any implementation (if feasible) would be scoped into a future phase or the external GSD PR. Per deferred ideas: "GSD framework: Add Explore agent to model profile lookup table (GSD PR)" — this is external, not this repo.

**Output:** Document findings in the plan summary. No code changes — this is pure research.

Per user decision: "Research properly how explore agent model selection actually works before deciding. Include as a research + decision task in the plan, not a build task yet."
  </action>
  <verify>
- Research findings are captured in the summary
- A clear decision is made: defer to future phase, defer to GSD external PR, or needs-more-research
- No code files are created or modified by this task
  </verify>
  <done>Explore agent model selection is researched. Decision documented as either "defer to future phase" or "defer to GSD external PR" with supporting rationale. Zero implementation — research output only.</done>
</task>

</tasks>

<verification>
1. squash-merge.md includes pre-merge divergence check, remote cleanup, tradeoffs section
2. Explore agent research has clear outcome documented in summary
</verification>

<success_criteria>
- /squash-merge follows industry best practice with all gaps addressed
- Tradeoff documentation present and accurate
- Explore agent decision made with supporting evidence
</success_criteria>

<output>
After completion, create `.planning/phases/08-hooks-workflows-review/08-02-SUMMARY.md`
</output>
